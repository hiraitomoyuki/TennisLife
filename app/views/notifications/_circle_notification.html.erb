<div class="container">
  <div class="col-md-10 offset-md-3">

    <% circle_notifications.each do |notification| %>
      <% if notification.visitor.present? %>
        <span>
          <%= attachment_image_tag(notification.visitor, :image, fallback: "no_image.png", size: "20x20", class: "img-circle") %>
          <%= link_to notification.visitor.nickname, user_path(notification.visitor) %>さんが
        </span>
      <% elsif notification.circle_visitor.present? %>
        <span>
          <%= link_to notification.circle_visitor.name, circle_path(notification.circle_visitor) %>さんが
        </span>
      <% end %>

      <% case notification.action %>
        <% when "circle" then %>
          <%= "サークルに加入しました。" %>

        <% when "withdrawal" then %>
          <%= "サークルから脱退しました。" %>

        <% when "follow" then %>
          <%= "サークルをフォローしました。" %>

        <% when "favorite" then %>
          <%= link_to "サークルの投稿", notification.article, style: "font-weight: bold;" %>
          <%= "にいいねしました。" %>

        <% when "entry" then %>
          <%= link_to "サークルの予定", schedules_path(circle_id: params[:circle_id]), style: "font-weight: bold;" %>
          <%= "に参加しました。" %>
          <p class="text-muted text-center mb-0">
            <%= notification.schedule.start_date.strftime("%Y-%m-%d") %>
            <%= notification.circle.title %>
          </p>

          <% when "comment" then %>
            <% if notification.comment.article.circle_id == notification.circle_visited.id %>
              <%= link_to "あなたの投稿", notification.article, style: "font-weight: bold;" %>
              <%= "にコメントをしました。" %>
            <% else %>
              <span>
                <%= link_to notification.comment.article.circle.name + "さんの投稿", article_path(notification.comment.article) %>
                <%= "にコメントをしました。" %>
              </span>
            <% end %>
            <p class="text-muted text-center mb-0">
              <%= notification.comment.comment %>
            </p>

          <% when "article" then %>
            <%=link_to " 新しいサークル活動記録", notification.schedule, style: "font-weight: bold;" %>
            <%= "を投稿しました。" %>

          <% when "schedule" then %>
            <%= link_to "新しい予定", notification.schedule, style: "font-weight: bold;" %>
            <%= "を作成しました。" %>
            <p class="text-muted text-center mb-0">
              <%= notification.schedule.start_date.strftime("%Y-%m-%d") %>
              <%= notification.schedule.title %>
            </p>

          <% when "approval" then %>
            <% if notification.schedule_id.nil? %>
              <%= link_to "サークルへの加入", approvals_circle_path(id: notification.circle_visited), style: "font-weight: bold;" %>
              <%= "を希望しています。" %>
            <% else %>
              <%= link_to "予定への参加", approvals_circle_path(id: notification.circle_visited), style: "font-weight: bold;" %>
              <%= "を希望しています。" %>
            <% end %>

        <% end %>
        <div class="small text-muted text-right">
          <%= time_ago_in_words(notification.created_at).upcase %><%= "前" %>
        </div>
        <hr>
      <% end %>
    
  </div>
</div>